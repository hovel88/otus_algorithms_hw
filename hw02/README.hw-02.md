# ДЗ 02: Счастливые билеты

## Цель

* Решить задачу "Счастливые билеты" и проверить решение по тестам
* Создать систему тестирования на основе файлов

## Решение

### Описание алгоритма

Имеется билет с четным количеством цифр (**2N**) в нем. Счастливым он считается, если  сумма цифр в левой половине равна сумме цифр в правой половине числа.

Рассмотрим одну половину.

Возможных вариантов цифр (**d**) в каждом разряде числа у нас всего 10 (от 0 до 9).

Для каждой размерности/разрядности (**N**) сумма (**s**) будет зависеть от суммы вариантов предыдущей размерности (**N-1**), а именно: для каждой цифры **d** в размерности/разряде **N** сумма цифр в оставшейся **N-1** должна дать `ss=s-d`, где `s-d>=0`.

Чтобы определить общее количество вариантов для данной частной суммы цифр, нужно просуммировать количество вариантов сумм для **d** от 0 до 9.

Т.е. рассматриваем для разряда/размерности **N** одну цифру **d**, вычисляем количество вариантов сумм с ней, далее переходим к следующей вариации цифры **d**, вычисляем количество вариантов сумм с ней и т.д.

Просуммировав результаты для каждой цифры **d**, мы получаем общий результат для этой частной суммы цифр **s**. Переходим к следующей и повторяем вычисления (опять для каждого варианта цифры) и т.д.

Так как в билете число с четным количеством цифр (**2N**), а мы посчитали количество сумм только для одной его половинки (**N**), то столько же сумм будет и для другой его половинки. Поэтому, возводим в квадрат и суммируем полученные частные результаты.

Для примера рассмотрим двузначное число:

```text
двузначное (N=2) число XX.
максимальная сумма цифр может быть 18 (число 99).
пробегаемся для каждой частной суммы от 0 до 18. в цикле:
  частная сумма s=0.
    ...

  частная сумма s=1.
    ...

  частная сумма s=17.
    выбираем один разряд.
    цифры могут быть от 0 до 9. в цикле:
      цифра X0 (d=0).
        значит сумма цифр оставшихся разрядов: ss=17-0=17 (17>=0).
        смотрим предыдущую размерность (N-1).
        количество вариантов, чтобы получить сумму 17 у однозначного (N=1) числа = 0
      цифра X1 (d=1).
        ...
        количество вариантов, чтобы получить сумму 16 у однозначного (N=1) числа = 0
      ...
      цифра X8 (d=8).
        значит сумма цифр оставшихся разрядов: ss=17-8=9 (9>=0).
        смотрим предыдущую размерность (N-1).
        количество вариантов, чтобы получить сумму 9 у однозначного (N=1) числа = 1
      цифра X9 (d=9).
        значит сумма цифр оставшихся разрядов: ss=17-9=8 (8>=0).
        смотрим предыдущую размерность (N-1).
        количество вариантов, чтобы получить сумму 8 у однозначного (N=1) числа = 1
    суммируем полученные варианты по всем цифрам:
    total=0+0+0+0+0+0+0+0+1+1=2.
    итого, для частной суммы s=17 для двузначного числа (XX) может быть 2 варианта.

  частная сумма s=18.
    ...

закончив со всеми частными суммами двузначного числа (XX), а изначальный билет имеет четное количество цифр (2N), то остается возвести в квадрат и затем просуммировать полученные результаты по частным суммам. 
получаем 670
```

| s | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15 | 16 | 17 | 18 | 19 | 20 | 21 | 22 | 23 | 24 | 25 | 26 | 27 |
| -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- |
| matrix[0][s] | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |
| matrix[1][s] | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |
| matrix[2][s] | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 9 | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |
| matrix[3][s] | 1 | 3 | 6 | 10 | 15 | 21 | 28 | 36 | 45 | 55 | 63 | 69 | 73 | 75 | 75 | 73 | 69 | 63 | 55 | 45 | 36 | 28 | 21 | 15 | 10 | 6 | 3 | 1 |

### Реализация алгоритма

Исходники с алгоритмом решения находятся в каталоге `hw02/issue_tickets/`:

* файл `hw02/issue_tickets/tickets_algo.cpp` реализации алгоритма (находится в функции _calculate())
* файл `hw02/issue_tickets/tickets_algo.h` объявление функции, для доступа из main() и из системы тестирования
* файл `hw02/issue_tickets/main.cpp` - собственно сама main()

Для сборки исходников запустить `make`:

```bash
dmitry@lachugin:~/lachugin_algorithms_hw/hw02/issue_tickets$ make
g++ -lstdc++fs -std=c++17 -Wall -I. -O2 -o hw02_tickets main.cpp tickets_algo.cpp
g++ -lstdc++fs -std=c++17 -Wall -I. -O2 -o hw02_tickets_checker checker.cpp checker_internals.cpp tickets_algo.cpp
```

В итоге будет сформировано два бинарных файла:  

* **hw02_tickets** (непосредственно программа подсчета числа счастливых билетов)
* **hw02_tickets_checker** (система тестирования алгоритма через файлы, о ней ниже)

Проверяем решение:
> Посчитать, сколько существует счастливых 6-значных билетов.

Пример вывода:

```bash
dmitry@lachugin:~/lachugin_algorithms_hw/hw02/issue_tickets$ ./hw02_tickets
Программа подсчета количества счастливых билетов с четным числом цифр
Цифр в билете 2N, где N=[1..10]. Введите N: 3
Количество счастливых билетов: 55252
```

### Система тестирования файлами

Файлы для системы тестирования через файлы находятся в каталоге `hw02/issue_tickets/1.Tickets`.

Исходники с реализацией системы тестирования через файлы находятся в каталоге `hw02/issue_tickets/`:

* файл `hw02/issue_tickets/checker_internals.cpp` реализации core-функций (подготовка списка файлов, считывания файлов, формирование тестового плана, выполнение тесового плана)
* файл `hw02/issue_tickets/checker_internals.h` объявление core-функций
* файл `hw02/issue_tickets/checker.cpp` - собственно сама main()

Система универсальна, достаточно исправить только функцию main(), чтобы указать какую функцию мы тестируем, а также задать путь к каталогу с файлами для тестирования. А также добавить включение заголовочного файла с тестируемым алгоритмом.

Пример запуска:

```bash
dmitry@lachugin:~/lachugin_algorithms_hw/hw02/issue_tickets$ ./hw02_tickets_checker 
Тест 0: успех
Тест 1: успех
Тест 2: успех
Тест 3: успех
Тест 4: успех
Тест 5: успех
Тест 6: успех
Тест 7: успех
Тест 8: успех
Тест 9: успех
------------------
Количество тестов: 10
Успешно          : 10
Провалено        : 0
```
